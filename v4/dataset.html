<!DOCTYPE html>
<html>

<!-- Mirrored from mbostock.github.com/d3/ex/choropleth.html by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 04 Feb 2012 16:43:26 GMT -->

<head>
	<meta http-equiv="content-type" content="text/html;charset=utf-8">
	<title>Loading data</title>
	<script type="text/javascript" src="d3.min.js"></script>
	<style type="text/css">
		div.tooltip {
			position: absolute;
			text-align: center;
			width: 60px;
			height: 28px;
			padding: 2px;
			font: 12px sans-serif;
			background: lightblue;
			border: 0px;
			border-radius: 8px;
			pointer-events: none;
		}
		body{
			background-color: white;
		}
		.selected{
			opacity: 1;
		}
		.unselected{
			opacity: 0.1;
		}
		.yaxis line{
  		stroke: black;
		}

		.yaxis path{
  		stroke: black;
		}
		.xaxis line{
  		stroke: black;
		}

		.xaxis path{
  		stroke: black;
		}

		.xaxis text{
		  fill: black;
		}
		.yaxis text{
			fill: black;
		}
	</style>
</head>

<body>
	<div align="center">
		<h1>Loading data</h1>
	</div>
	<div id='chart' align="center">
	</div>
</body>

<script type="text/javascript">
var height=550;
var width=550;
var color = d3.scaleOrdinal(d3.schemeCategory10);

	var div = d3.select("body").append("div")
		.attr("class", "tooltip")
		.style("opacity", 0);

	var data = [];
	d3.csv("pca.csv").then(function(rows) {
		console.log(rows)
		rows=rows.sort(function(a,b){ return d3.ascending(a.target, b.target);});
		var x = d3.scaleLinear()
			.range([0, width-10]);

		var y = d3.scaleLinear()
			.range([height-10, 0]);
		var xAxis = d3.axisBottom(x);
		var yAxis = d3.axisLeft(y);
		var x = d3.scaleLinear()
			.domain(d3.extent(rows, function(d) {
				return +d.X1
			}))
			.range([10, width-10]);
		var y = d3.scaleLinear()
			.domain(d3.extent(rows, function(d) {
				return +d.X2
			}))
			.range([10, height-10]);

		var svg = d3.select("body").append("svg")
			.attr("width", width)
			.attr("height", height)
			.append("g")
			.attr("transform", "translate("+50+","+(-50)+")")
		svg.selectAll("circle").data(rows).enter()
			.append("circle")
			.attr("cx", function(d) {
				return x(d.X1);
			})
			.attr("cy", function(d) {
				return height - x(d.X2);
			})
			.attr("r", "2")
			.attr("fill", function(d) {
				return color(d.target)
			})
			.attr("opacity", function(d) {
				if (d.target == 0) {
					return "1";
				} else {
					return "1";
				}
			})
			.attr("identifier", function(d) {
				return d.ID;
			})
			.on("mouseover", function(d) {
				div.transition()
					.duration(200)
					.style("opacity", .9);
				div.html(d.ID)
					.style("left", (d3.event.pageX) + "px")
					.style("top", (d3.event.pageY - 28) + "px");
			})
			.on("mouseout", function(d) {
				div.transition()
					.duration(500)
					.style("opacity", 0);
			});

		svg.append("g")
			.attr("class", "xaxis")
			.attr("transform", "translate(0," + width + ")")
			.call(xAxis)
			.append("text")
			.attr("class", "label")
			.attr("x", width)
			.attr("y", height)
			.style("text-anchor", "start")
			.text("X1");

		svg.append("g")
			.attr("class", "yaxis")
			.call(yAxis)
			.append("text")
			.attr("class", "label")
			.attr("transform", "rotate(-90)")
			.attr("y", 6)
			.attr("dy", ".71em")
			.style("text-anchor", "start")
			.text("X2");

			var legend = d3.select("svg").selectAll(".legend")
					 .data(color.domain())
					 .enter().append("g")
					 .classed("legend", true)
					 .attr("transform", function(d, i) {
							 return "translate(0," + i * 20 + ")";
					 })
					 .attr("class", "selected");
			legend.append("rect")
				    .attr("x", width -140)
						.attr("y", 20)
				    .attr("width", 12)
				    .attr("height", 12)
				    .style("fill", color)
						.on("mousedown", function(t){
							d3.selectAll(".selected").attr("class", "unselected");
						})
						.on("mouseup", function(t){
							d3.select(this).attr("class", "selected");
						});
			legend.append("text")
					   .attr("x", width - 116)
						 .attr("y", 20)
					   .attr("dy", ".65em")
					   .text(function(d) {
					    	if (d==0){
									return "Correct";
								}
								else{
									return "Default";
								}
					    });

	});

</script>

</html>
